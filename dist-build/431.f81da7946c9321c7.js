"use strict";(self.webpackChunkmaterial=self.webpackChunkmaterial||[]).push([[431],{5431:(it,C,a)=>{a.r(C),a.d(C,{QuestionsModule:()=>nt});var h=a(6895),v=a(9132),U=a(105),u=a(3626),T=a(8739),b=a(6308),g=a(3162),P=a(1572),t=a(4650),A=a(529),x=a(4004),y=a(7456);let q=(()=>{class n{constructor(e,o){this.http=e,this.configService=o}getQuestions(){const e=this.configService.getApiUrl()+"questions/";return this.http.get(e)}getQuestionTitles(e,o){let i=this.configService.getApiUrl()+"questions/titles",r=new A.LE;return e&&(r=r.set("page_size",e.toString())),o&&(r=r.set("page",o.toString())),console.log(i),console.log("Params:",r),this.http.get(i,{params:r}).pipe((0,x.U)(l=>(l.results=l.results.map(m=>({...m,selected:!1})),l)))}getQuestionDetails(e){const o=this.configService.getApiUrl()+`questions/details/${e}`;return this.http.get(o)}processQuestion(e){const o=this.configService.getApiUrl()+"questions/answer_single/";return this.http.post(o,{question:e})}processQuestions(e){const o=this.configService.getApiUrl()+"questions/answer_multiple/";return this.http.post(o,{ids:e})}checkProgress(e){const o=this.configService.getApiUrl()+"questions/check_progress/";return this.http.post(o,{ids:e})}getToken(){const o=document.cookie.split("; ").find(i=>i.startsWith("token="));return o?o.split("=")[1]:null}getPrompt(){const e=this.configService.getApiUrl()+"questions/fetch_prompt";return this.http.get(e)}updatePrompt(e){const o=this.configService.getApiUrl()+"questions/update_prompt/";return this.http.post(o,{prompt:e})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(A.eN),t.LFG(y.E))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var _=a(4859),c=a(3546),S=a(6709),w=a(3683);function Q(n,s,e,o,i,r,l){try{var m=n[r](l),d=m.value}catch(st){return void e(st)}m.done?s(d):Promise.resolve(d).then(o,i)}var p=a(5938),M=a(9549),O=a(4144),f=a(4006);const G=["progressBar"];function k(n,s){1&n&&(t.TgZ(0,"div",10),t._uU(1," Error: Unable to save Chat GPT Prompt\n"),t.qZA())}let B=(()=>{class n{constructor(e,o){this.dialogRef=e,this.data=o,this.error=!1}onNoClick(){this.dialogRef.close()}updatePrompt(){this.error=!1,this.progressBar.mode="indeterminate",console.log(this.data.prompt),this.data.service.updatePrompt(this.data.prompt).subscribe({next:e=>{console.log(e),this.progressBar.mode="determinate",this.progressBar.value=100,this.dialogRef.close()},error:e=>{this.progressBar.mode="determinate",this.progressBar.value=30,this.error=!0,console.error(e)},complete:()=>{}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.so),t.Y36(p.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-prompt-dialog"]],viewQuery:function(e,o){if(1&e&&t.Gf(G,7),2&e){let i;t.iGM(i=t.CRH())&&(o.progressBar=i.first)}},decls:16,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[2,"white-space","pre-line"],["matInput","","rows","8","placeholder","Type your message here",3,"ngModel","ngModelChange"],["mode","determinate","value","0"],["progressBar",""],["class","alert alert-danger","role","alert",4,"ngIf"],["mat-dialog-actions",""],["mat-raised-button","","color","primary","tabindex","2",3,"click"],["mat-raised-button","","tabindex","-1",3,"click"],["role","alert",1,"alert","alert-danger"]],template:function(e,o){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Chat GPT PROMPT"),t.qZA(),t.TgZ(2,"div",1)(3,"p",2),t._uU(4),t.qZA(),t.TgZ(5,"mat-form-field")(6,"textarea",3),t.NdJ("ngModelChange",function(r){return o.data.prompt=r}),t.qZA()()(),t._UZ(7,"mat-progress-bar",4,5)(9,"br"),t.YNc(10,k,2,0,"div",6),t.TgZ(11,"div",7)(12,"button",8),t.NdJ("click",function(){return o.updatePrompt()}),t._uU(13,"Update Prompt"),t.qZA(),t.TgZ(14,"button",9),t.NdJ("click",function(){return o.onNoClick()}),t._uU(15,"Cancel"),t.qZA()()),2&e&&(t.xp6(4),t.hij(" ",o.data.prompt,""),t.xp6(2),t.Q6J("ngModel",o.data.prompt),t.xp6(4),t.Q6J("ngIf",o.error))},dependencies:[h.O5,_.lW,p.uh,p.xY,p.H8,M.KE,O.Nt,g.pW,f.Fj,f.JJ,f.On],styles:["mat-form-field[_ngcontent-%COMP%], mat-dialog-content[_ngcontent-%COMP%]{flex:none;display:inline}"]}),n})();var I=a(6805);let J=(()=>{class n{constructor(e){this.dialog=e,this.prompt=""}view_edit_prompt(){var e=this;return function D(n){return function(){var s=this,e=arguments;return new Promise(function(o,i){var r=n.apply(s,e);function l(d){Q(r,o,i,l,m,"next",d)}function m(d){Q(r,o,i,l,m,"throw",d)}l(void 0)})}}(function*(){try{const o=e.dataService.getPrompt();let i=yield function N(n,s){const e="object"==typeof s;return new Promise((o,i)=>{let l,r=!1;n.subscribe({next:m=>{l=m,r=!0},error:i,complete:()=>{r?o(l):e?o(s.defaultValue):i(new I.K)}})})}(o);e.prompt=i.prompt,console.log("prompt"+e.prompt);const l=yield e.dialog.open(B,{width:"45%",data:{prompt:e.prompt,service:e.dataService}}).afterClosed().toPromise();console.log("The dialog was closed"),console.error(l)}catch(o){console.error(o)}})()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-control-panel"]],inputs:{dataService:"dataService"},decls:7,vars:0,consts:[[1,"row"],[1,"col-md-3"],["mat-raised-button","","color","primary",3,"click"],[1,"col-md-6"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return o.view_edit_prompt()}),t._uU(3,"View / Edit CHAT GPT Prompt"),t.qZA()(),t._UZ(4,"div",3)(5,"div",1),t.qZA(),t._UZ(6,"hr"))},dependencies:[_.lW]}),n})();function Y(n,s){if(1&n&&(t.TgZ(0,"div",2)(1,"div",19)(2,"mat-toolbar",20)(3,"span")(4,"code",21),t._uU(5,"Status: "),t.qZA()(),t.TgZ(6,"span",22),t._uU(7," \xa0 "),t.qZA(),t.TgZ(8,"span"),t._uU(9),t.qZA()()()()),2&n){const e=t.oxw();t.xp6(9),t.hij(" ",e.status_response,"")}}function R(n,s){1&n&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Title"),t.qZA())}const Z=function(n){return["question-details",n]};function H(n,s){if(1&n&&(t.TgZ(0,"mat-cell")(1,"a",23),t._uU(2),t.qZA()()),2&n){const e=s.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,Z,e.no)),t.xp6(1),t.Oqu(e.title)}}function E(n,s){1&n&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Category"),t.qZA())}function F(n,s){if(1&n&&(t.TgZ(0,"mat-cell")(1,"a",23),t._uU(2),t.qZA()()),2&n){const e=s.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,Z,e.no)),t.xp6(1),t.Oqu(e.category)}}function V(n,s){1&n&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Generate Answers"),t.qZA())}function W(n,s){if(1&n&&(t.TgZ(0,"mat-cell")(1,"button",24),t._uU(2,"Process Text"),t.qZA()()),2&n){const e=s.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(1,Z,e.no))}}function z(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"mat-header-cell")(1,"mat-checkbox",25),t.NdJ("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.toggleSelectAll())}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("checked",e.allSelected)}}function L(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"mat-cell")(1,"mat-checkbox",25),t.NdJ("change",function(){const r=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.toggleSelection(r))}),t.qZA()()}if(2&n){const e=s.$implicit;t.xp6(1),t.Q6J("checked",e.selected)}}function $(n,s){1&n&&t._UZ(0,"mat-header-row")}function j(n,s){1&n&&t._UZ(0,"mat-row")}const K=function(){return[5,10,20,50,100,200,500,1e3,2e3,5e3,1e4]};let X=(()=>{class n{constructor(e){this.questionService=e,this.allSelected=!1,this.totalItems=0,this.columnsToDisplay=["title","category","generate","select"],this.table_source=new u.by}ngOnInit(){this.progressBar.mode="indeterminate",this.fetchData()}ngAfterViewInit(){this.table_source.sort=this.sort,this.paginator.page.subscribe(()=>{this.progressBar.mode="indeterminate",console.log(this.paginator.pageSize,this.paginator.pageIndex.toString()),this.fetchData(this.paginator.pageSize,this.paginator.pageIndex.toString())})}fetchData(e,o){this.questionService.getQuestionTitles(e,o).subscribe({next:i=>{this.question_titles=i,console.log("Value of question titles:",this.question_titles),this.totalItems=this.question_titles.count,this.table_source.data=this.question_titles.results,this.paginator.length=this.totalItems,this.paginator.pageIndex=this.paginator.pageIndex,this.paginator.pageSize=e||this.paginator.pageSize,this.progressBar.mode="determinate",console.log("Paginator:",this.table_source.paginator),console.log("Value of this.table_source:",this.table_source.data)},error:i=>{console.error(i)}})}generateAnswers(){if(this.progressBar.mode="indeterminate",this.selected_ids=[],this.selected_ids=this.getSelectedItems().map(e=>e.no),console.log(this.selected_ids),this.selected_ids=this.getSelectedItems().map(e=>e.no),0===this.selected_ids.length)return this.status_response="Please choose atleast one question",void(this.progressBar.mode="determinate");this.questionService.processQuestions(this.selected_ids).subscribe({next:e=>{this.status_response=e.status,this.saved_ids=e.saved_ids,console.log(this.status_response,this.saved_ids)},error:e=>{console.error(e),this.status_response=e},complete:()=>{this.startPolling(this.saved_ids)}})}startPolling(e){this.intervalId=setInterval(()=>{this.questionService.checkProgress(e).subscribe({next:o=>{console.log(o),this.process_status=o.status,this.status_response=o.msg,console.log(this.status_response)},error:o=>{console.error(o),this.status_response=o},complete:()=>{"Complete"==this.process_status&&(this.progressBar.mode="determinate",this.stopPolling())}})},5e3)}stopPolling(){clearInterval(this.intervalId)}toggleSelectAll(){this.allSelected=!this.allSelected,this.table_source.data.forEach(e=>e.selected=this.allSelected),console.log("Value of this.table_source:",this.table_source.data)}toggleSelection(e){e.selected=!e.selected,this.table_source.data=this.table_source.data.slice(),console.log("Value of this.table_source:",this.table_source.data)}getSelectedItems(){return console.log("Value of this.table_source:",this.table_source.data.filter(e=>e.selected)),this.table_source.data.filter(e=>e.selected)}getQuestionService(){return this.questionService}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(q))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-questions-all-questions"]],viewQuery:function(e,o){if(1&e&&(t.Gf(g.pW,7),t.Gf(P.Cq,7),t.Gf(T.NW,5),t.Gf(b.YE,5)),2&e){let i;t.iGM(i=t.CRH())&&(o.progressBar=i.first),t.iGM(i=t.CRH())&&(o.progressBarSpinner=i.first),t.iGM(i=t.CRH())&&(o.paginator=i.first),t.iGM(i=t.CRH())&&(o.sort=i.first)}},decls:37,vars:9,consts:[[3,"dataService"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-1"],[1,"col-md-10"],[1,"mat-elevation-z8","custom-table",3,"dataSource"],["matColumnDef","title"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","category"],["matColumnDef","generate"],["matColumnDef","select"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"button-row"],["showFirstLastButtons","",3,"pageSizeOptions","length"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","primary"],["mode","determinate"],[1,"col-md-12"],["color","accent"],[1,""],[1,"example-fill-remaining-space"],[3,"routerLink"],["mat-raised-button","","color","primary",3,"routerLink"],[3,"checked","change"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-subtitle"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-title"),t._uU(5,"Generate Answers with Chat GPT"),t.qZA()(),t.TgZ(6,"mat-card-content"),t._UZ(7,"app-control-panel",0),t.YNc(8,Y,10,1,"div",1),t.TgZ(9,"div",2),t._UZ(10,"div",3),t.TgZ(11,"div",4)(12,"mat-table",5),t.ynx(13,6),t.YNc(14,R,2,0,"mat-header-cell",7),t.YNc(15,H,3,4,"mat-cell",8),t.BQk(),t.ynx(16,9),t.YNc(17,E,2,0,"mat-header-cell",7),t.YNc(18,F,3,4,"mat-cell",8),t.BQk(),t.ynx(19,10),t.YNc(20,V,2,0,"mat-header-cell",7),t.YNc(21,W,3,3,"mat-cell",8),t.BQk(),t.ynx(22,11),t.YNc(23,z,2,1,"mat-header-cell",7),t.YNc(24,L,2,1,"mat-cell",8),t.BQk(),t.YNc(25,$,1,0,"mat-header-row",12),t.YNc(26,j,1,0,"mat-row",13),t.qZA()(),t._UZ(27,"div",3),t.qZA()(),t.TgZ(28,"mat-card-actions")(29,"div",14),t._UZ(30,"mat-paginator",15),t.TgZ(31,"button",16),t.NdJ("click",function(){return o.generateAnswers()}),t._uU(32,"Process Text Using Chat GPT"),t.qZA(),t.TgZ(33,"button",17),t._uU(34,"Queue Questions for Processing"),t.qZA()()(),t.TgZ(35,"mat-card-footer"),t._UZ(36,"mat-progress-bar",18),t.qZA()()),2&e&&(t.xp6(3),t.hij("Available questions: ",null==o.question_titles?null:o.question_titles.count,""),t.xp6(4),t.Q6J("dataService",o.getQuestionService()),t.xp6(1),t.Q6J("ngIf",o.status_response),t.xp6(4),t.Q6J("dataSource",o.table_source),t.xp6(13),t.Q6J("matHeaderRowDef",o.columnsToDisplay),t.xp6(1),t.Q6J("matRowDefColumns",o.columnsToDisplay),t.xp6(4),t.Q6J("pageSizeOptions",t.DdM(8,K))("length",o.totalItems))},dependencies:[h.O5,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,v.rH,_.lW,c.a8,c.hq,c.dn,c.rt,c.dk,c.$j,c.n5,S.oG,T.NW,g.pW,w.Ye,J],styles:[".custom-table[_ngcontent-%COMP%]   mat-header-cell.mat-column-title[_ngcontent-%COMP%], mat-cell.mat-column-title[_ngcontent-%COMP%]{width:60%}.custom-table[_ngcontent-%COMP%]   mat-header-cell.mat-column-category[_ngcontent-%COMP%], mat-cell.mat-column-category[_ngcontent-%COMP%]{width:15%}.custom-table[_ngcontent-%COMP%]   mat-header-cell.mat-column-generate[_ngcontent-%COMP%], mat-cell.mat-column-generate[_ngcontent-%COMP%]{width:20%}.custom-table[_ngcontent-%COMP%]   mat-cell.mat-column-selct[_ngcontent-%COMP%]{width:5%}mat-cell[_ngcontent-%COMP%], mat-header-cell[_ngcontent-%COMP%], mat-footer-cell[_ngcontent-%COMP%]{flex:none}"]}),n})();var tt=a(4850);function et(n,s){if(1&n&&(t.TgZ(0,"div"),t._UZ(1,"mat-divider")(2,"br"),t.TgZ(3,"mat-card-title"),t._uU(4,"Generated answer"),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.qZA(),t._UZ(7,"mat-divider"),t.qZA()),2&n){const e=t.oxw();t.xp6(6),t.Oqu(e.cleaned_text)}}const ot=[{path:"",component:X},{path:"question-details/:id",component:(()=>{class n{constructor(e,o){this.route=e,this.questionService=o,this.is_cleaned=!1}ngOnInit(){const e=this.route.snapshot.paramMap.get("id");null!==e?(this.id=e,this.questionService.getQuestionDetails(this.id).subscribe({next:o=>{this.question_details=o},error:o=>{console.error(o)}})):console.log("Error...param was none")}processText(){this.progressBar.mode="indeterminate";const e={question:this.question_details.content};console.log(e),this.questionService.processQuestion(e).subscribe({next:o=>{this.cleaned_text=o.cleaned_text,console.log(this.cleaned_text)},error:o=>{console.error(o),this.cleaned_text=o},complete:()=>{this.is_cleaned=!0,this.progressBar.mode="determinate"}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v.gz),t.Y36(q))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-question-details"]],viewQuery:function(e,o){if(1&e&&t.Gf(g.pW,7),2&e){let i;t.iGM(i=t.CRH())&&(o.progressBar=i.first)}},decls:41,vars:7,consts:[["width","70%","align","center"],[4,"ngIf"],[1,"button-row"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","primary"],["mode","determinate"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"mat-card-subtitle"),t._uU(3,"Question details"),t.qZA(),t.TgZ(4,"mat-card-title"),t._uU(5),t.qZA()(),t.TgZ(6,"mat-card-content"),t._UZ(7,"mat-divider"),t.TgZ(8,"p"),t._uU(9),t.qZA(),t._UZ(10,"mat-divider")(11,"br"),t.TgZ(12,"table",0)(13,"tr")(14,"th"),t._uU(15,"Content Length"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Category"),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA()(),t.TgZ(22,"tr")(23,"th"),t._uU(24,"Date Scraped"),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Date Updated"),t.qZA(),t.TgZ(29,"td"),t._uU(30),t.qZA()()(),t._UZ(31,"br"),t.YNc(32,et,8,1,"div",1),t.qZA(),t.TgZ(33,"mat-card-actions")(34,"div",2)(35,"button",3),t.NdJ("click",function(){return o.processText()}),t._uU(36,"Process Text Using Chat GPT"),t.qZA(),t.TgZ(37,"button",4),t._uU(38,"Edit Question Using Chat GPT"),t.qZA()()(),t.TgZ(39,"mat-card-footer"),t._UZ(40,"mat-progress-bar",5),t.qZA()()),2&e&&(t.xp6(5),t.Oqu(o.question_details.title),t.xp6(4),t.Oqu(o.question_details.content),t.xp6(8),t.Oqu(o.question_details.content_length),t.xp6(4),t.Oqu(o.question_details.category),t.xp6(5),t.Oqu(o.question_details.date_scraped),t.xp6(4),t.Oqu(o.question_details.date_recorded),t.xp6(2),t.Q6J("ngIf",o.is_cleaned))},dependencies:[h.O5,_.lW,c.a8,c.hq,c.dn,c.rt,c.dk,c.$j,c.n5,tt.d,g.pW],styles:[".mat-card[_ngcontent-%COMP%]{padding:16px!important;margin:0}"]}),n})()}];let nt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.ez,u.p0,v.Bz.forChild(ot),U.O,f.u5]}),n})()}}]);